<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Still Here</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=Jost:wght@200;300;400&display=swap');

/* ── TOKENS ─────────────────────────────────────── */
:root {
  --bg:        #06080f;
  --gold:      #c8a44a;
  --gold-soft: rgba(200,164,74,0.22);
  --gold-line: rgba(200,164,74,0.35);

  /* Text scale — slightly dominant, never harsh */
  --t1: rgba(238,228,208,0.94);   /* headings, numbers      */
  --t2: rgba(238,228,208,0.72);   /* body, main lines        */
  --t3: rgba(238,228,208,0.46);   /* secondary, labels       */
  --t4: rgba(238,228,208,0.28);   /* ghost, hints            */

  /* Card anatomy */
  --card-w:    clamp(72px,14vw,96px);
  --card-h:    clamp(84px,16vw,112px);
  --card-r:    8px;
  --card-bg:   #0e1220;
  --card-top:  #111827;
  --card-bot:  #0b0f1a;
  --card-edge: #080b14;
  --card-num:  clamp(2.2rem,6.5vw,3.6rem);
}

*,*::before,*::after { margin:0; padding:0; box-sizing:border-box; }
html { scroll-behavior:smooth; }

body {
  background: var(--bg);
  color: var(--t1);
  font-family: 'Cormorant Garamond', Georgia, serif;
  overflow-x: hidden;
}

/* Grain overlay */
body::after {
  content:''; position:fixed; inset:0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.82' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.038'/%3E%3C/svg%3E");
  pointer-events:none; z-index:2000; opacity:0.22;
}

#progress-line {
  position:fixed; top:0; left:0;
  height:1px; width:0%;
  background:linear-gradient(90deg,transparent,var(--gold) 45%,transparent);
  z-index:1999; transition:width 0.08s linear;
}

section {
  min-height:100vh; display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  padding:6rem 1.5rem; position:relative;
}

/* ════════════════════════════════════════════════
   STARS
════════════════════════════════════════════════ */
.star-field { position:absolute; inset:0; overflow:hidden; pointer-events:none; }
.star {
  position:absolute; border-radius:50%; background:#fff;
  animation:tw var(--d,3s) ease-in-out infinite var(--dl,0s);
}
@keyframes tw {
  0%,100% { opacity:var(--lo,.05); }
  50%      { opacity:var(--hi,.45); }
}

/* ════════════════════════════════════════════════
   COUNTDOWN SECTION
════════════════════════════════════════════════ */
#countdown-section {
  background: radial-gradient(ellipse at 50% 38%, #0d1120 0%, #06080f 70%);
  gap:0;
}

/* — Eyebrow label — */
.clock-eyebrow {
  font-family:'Jost',sans-serif; font-weight:200;
  font-size:clamp(0.6rem,1.4vw,0.7rem);
  letter-spacing:0.44em; text-transform:uppercase;
  color:var(--t4); margin-bottom:2.6rem;
  opacity:0; transition:opacity 1.6s ease 0.3s;
}
.clock-eyebrow.visible { opacity:1; }

/* — Clock row — */
.flip-clock {
  display:flex; align-items:flex-start; gap:clamp(10px,2.5vw,20px);
  opacity:0; transform:translateY(10px);
  transition:opacity 1.2s ease 0.55s, transform 1.2s ease 0.55s;
}
.flip-clock.visible { opacity:1; transform:translateY(0); }

/* — One digit unit (wraps card + label) — */
.flip-unit { display:flex; flex-direction:column; align-items:center; gap:10px; }

/* — The card itself — */
.f-card {
  position:relative;
  width: var(--card-w);
  height:var(--card-h);
  perspective:600px;
  /* physical drop-shadow */
  filter: drop-shadow(0 12px 32px rgba(0,0,0,0.7)) drop-shadow(0 2px 4px rgba(0,0,0,0.5));
}

/* Back plate visible behind everything — gives depth/edge */
.f-card-back {
  position:absolute; inset:0;
  background:var(--card-edge);
  border-radius:var(--card-r);
  transform:translateY(2px);
}

/* ── TOP HALF (resting) ── */
.f-top-half {
  position:absolute; top:0; left:0; right:0;
  height:50%; overflow:hidden;
  border-radius:var(--card-r) var(--card-r) 0 0;
  background:var(--card-top);
  /* subtle inner glow at top edge */
  box-shadow:inset 0 1px 0 rgba(255,255,255,0.06), inset 0 -1px 0 rgba(0,0,0,0.4);
  z-index:2;
}
.f-top-half-num {
  /* position the number so it sits centred across the full card height */
  position:absolute; top:0; left:0; right:0; height:200%;
  display:flex; align-items:center; justify-content:center;
  font-family:'Jost',sans-serif; font-weight:300; letter-spacing:-0.04em;
  font-size:var(--card-num); color:var(--t1);
  user-select:none;
}

/* ── BOTTOM HALF (resting, slightly darker) ── */
.f-bot-half {
  position:absolute; bottom:0; left:0; right:0;
  height:50%; overflow:hidden;
  border-radius:0 0 var(--card-r) var(--card-r);
  background:var(--card-bot);
  box-shadow:inset 0 1px 0 rgba(0,0,0,0.45), inset 0 -1px 0 rgba(255,255,255,0.03);
  z-index:2;
}
.f-bot-half-num {
  /* position so number aligns with bottom half */
  position:absolute; top:-100%; left:0; right:0; height:200%;
  display:flex; align-items:center; justify-content:center;
  font-family:'Jost',sans-serif; font-weight:300; letter-spacing:-0.04em;
  font-size:var(--card-num); color: rgba(238,228,208,0.82);
  user-select:none;
}

/* ── HORIZONTAL SEAM ── */
.f-seam {
  position:absolute; top:50%; left:0; right:0;
  height:2px;
  background: linear-gradient(to right,
    transparent 0%,
    rgba(0,0,0,0.7) 8%,
    rgba(0,0,0,0.85) 50%,
    rgba(0,0,0,0.7) 92%,
    transparent 100%
  );
  z-index:10; pointer-events:none;
  margin-top:-1px;
}

/* ── FLIP FLAP (animates on change) ── */
.f-flap {
  position:absolute; top:0; left:0; right:0;
  height:50%; overflow:hidden;
  border-radius:var(--card-r) var(--card-r) 0 0;
  transform-origin:bottom center;
  transform-style:preserve-3d;
  z-index:20;
  /* Not visible by default, only during animation */
  pointer-events:none;
}
.f-flap-face {
  position:absolute; top:0; left:0; right:0; height:200%;
  display:flex; align-items:center; justify-content:center;
  font-family:'Jost',sans-serif; font-weight:300; letter-spacing:-0.04em;
  font-size:var(--card-num); color:var(--t1);
  background:var(--card-top);
  border-radius:var(--card-r) var(--card-r) 0 0;
  box-shadow:inset 0 1px 0 rgba(255,255,255,0.06);
  backface-visibility:hidden; user-select:none;
}
/* shadow on the falling flap face — sells the 3D bend */
.f-flap-face::after {
  content:''; position:absolute; inset:0;
  background:linear-gradient(to bottom, transparent 40%, rgba(0,0,0,0.55));
  border-radius:inherit; pointer-events:none;
  opacity:0; transition:opacity 0.18s ease;
}

/* Reveal bottom flap */
.f-reveal {
  position:absolute; bottom:0; left:0; right:0;
  height:50%; overflow:hidden;
  border-radius:0 0 var(--card-r) var(--card-r);
  transform-origin:top center;
  transform-style:preserve-3d;
  transform:rotateX(90deg);
  z-index:19;
  pointer-events:none;
}
.f-reveal-face {
  position:absolute; bottom:0; left:0; right:0; height:200%;
  display:flex; align-items:center; justify-content:center;
  font-family:'Jost',sans-serif; font-weight:300; letter-spacing:-0.04em;
  font-size:var(--card-num); color:rgba(238,228,208,0.82);
  background:var(--card-bot);
  border-radius:0 0 var(--card-r) var(--card-r);
  box-shadow:inset 0 -1px 0 rgba(255,255,255,0.03);
  backface-visibility:hidden; user-select:none;
}

/* ── FLIP ANIMATIONS ── */
/* Phase 1: top flap folds down */
@keyframes flapFall {
  0%   { transform:rotateX(0deg); }
  100% { transform:rotateX(-90deg); }
}
/* Phase 2: bottom reveal unfolds up */
@keyframes revealRise {
  0%   { transform:rotateX(90deg); }
  100% { transform:rotateX(0deg); }
}
.f-flap.animating   { animation:flapFall   0.22s cubic-bezier(0.55,0,1,0.45) forwards; }
.f-reveal.animating { animation:revealRise 0.22s cubic-bezier(0,0.55,0.45,1) 0.22s forwards; }

/* shadow overlay that grows as flap falls */
.f-flap.animating .f-flap-face::after { opacity:1; }

/* ── UNIT LABEL ── */
.f-label {
  font-family:'Jost',sans-serif; font-weight:200;
  font-size:clamp(0.5rem,1.2vw,0.62rem);
  letter-spacing:0.32em; text-transform:uppercase;
  color:var(--t4);
}

/* ── COLON SEPARATOR ── */
.f-colon {
  display:flex; flex-direction:column; gap:6px;
  margin-top:clamp(26px,5vw,38px);
  padding-bottom:22px;
}
.f-dot {
  width:4px; height:4px; border-radius:50%;
  background:var(--gold-soft);
  box-shadow:0 0 6px 1px rgba(200,164,74,0.2);
}

/* ── COUNTDOWN TEXT ── */
.clock-below {
  margin-top:4rem;
  display:flex; flex-direction:column; align-items:center; gap:1.8rem;
  opacity:0; transform:translateY(10px);
  transition:opacity 1.5s ease 1.1s, transform 1.5s ease 1.1s;
  text-align:center;
}
.clock-below.visible { opacity:1; transform:translateY(0); }

.clock-main-line {
  font-family:'Cormorant Garamond',serif; font-style:italic; font-weight:300;
  font-size:clamp(1.1rem,3vw,1.38rem);
  color:var(--t2); letter-spacing:0.04em; line-height:1.55;
}

.clock-sub-lines {
  font-family:'Cormorant Garamond',serif; font-weight:300;
  font-size:clamp(0.88rem,2.2vw,1rem);
  color:var(--t3); line-height:2.2;
  letter-spacing:0.025em; max-width:380px;
}

/* ── SCROLL HINT ── */
.scroll-hint {
  position:absolute; bottom:2.8rem; left:50%; transform:translateX(-50%);
  display:flex; flex-direction:column; align-items:center; gap:0.55rem;
  opacity:0; animation:hintIn 1.8s ease 4s forwards;
}
.scroll-hint span {
  font-family:'Jost',sans-serif; font-weight:200;
  font-size:0.56rem; letter-spacing:0.4em; text-transform:uppercase;
  color:var(--t4);
}
.scroll-bar {
  width:1px; height:40px;
  background:linear-gradient(to bottom, var(--gold), transparent);
  animation:barPulse 2.4s ease-in-out infinite 4s;
}
@keyframes hintIn  { to { opacity:1; } }
@keyframes barPulse {
  0%,100% { opacity:0.25; transform:scaleY(1); }
  50%     { opacity:0.65; transform:scaleY(0.55); }
}

/* ════════════════════════════════════════════════
   OPENING SECTION
════════════════════════════════════════════════ */
#opening {
  background:linear-gradient(to bottom, #07090f, #0b0f1a);
  gap:1.8rem;
}

.opening-line {
  font-family:'Cormorant Garamond',serif; font-style:italic; font-weight:300;
  font-size:clamp(1.1rem,3.2vw,1.5rem);
  color:var(--t2); letter-spacing:0.04em;
  text-align:center; max-width:520px; line-height:1.65;
  opacity:0; transform:translateY(14px);
  transition:opacity 1.6s ease, transform 1.6s ease;
}
.opening-line.visible { opacity:1; transform:translateY(0); }
.opening-line.d1 { transition-delay:0.1s; }
.opening-line.d2 { transition-delay:0.6s; }
.opening-line.d3 { transition-delay:1.1s; color:var(--t1); }

.section-divider {
  width:1px; height:72px;
  background:linear-gradient(to bottom, transparent, var(--gold-line), transparent);
  margin:2.2rem auto; opacity:0;
  transition:opacity 1.5s ease 1.6s;
}
.section-divider.visible { opacity:1; }

/* ════════════════════════════════════════════════
   CAKE SECTION
════════════════════════════════════════════════ */
#cake-section {
  background:radial-gradient(ellipse at center 65%, #130d05 0%, #07090f 62%);
  gap:3rem;
}

.cake-title {
  font-family:'Jost',sans-serif; font-weight:200;
  font-size:clamp(0.58rem,1.6vw,0.72rem);
  letter-spacing:0.45em; text-transform:uppercase;
  color:var(--t4); opacity:0; transform:translateY(10px);
  transition:opacity 1.1s ease, transform 1.1s ease;
}
.cake-title.visible { opacity:1; transform:translateY(0); }

.cake-stage { position:relative; width:280px; height:320px; overflow:visible; }

.plate-group {
  position:absolute; bottom:0; left:50%;
  transform:translateX(-50%) translateY(-200px);
  transition:transform 0.8s cubic-bezier(0.25,1.4,0.5,1); opacity:0;
}
.plate-group.dropped { transform:translateX(-50%) translateY(0); opacity:1; }
.plate-ellipse {
  width:220px; height:22px;
  background:radial-gradient(ellipse at 40% 35%, #d4c4a0, #8a7652);
  border-radius:50%;
  box-shadow:0 4px 20px rgba(0,0,0,0.6), inset 0 2px 4px rgba(255,255,255,0.1);
}
.plate-rim {
  position:absolute; top:-5px; left:50%; transform:translateX(-50%);
  width:232px; height:14px;
  background:linear-gradient(to bottom, #c8b887, #7a6840);
  border-radius:50%; box-shadow:0 2px 8px rgba(0,0,0,0.5);
}

.layer {
  position:absolute; left:50%;
  transform:translateX(-50%) translateY(-300px);
  border-radius:12px 12px 6px 6px; opacity:0;
  transition:transform 0.7s cubic-bezier(0.22,1.4,0.36,1), opacity 0.3s ease;
}
.layer.dropped { opacity:1; }
.layer-1 {
  bottom:14px; width:200px; height:64px;
  background:linear-gradient(to bottom, #c4856a, #9a5e47);
  box-shadow:0 6px 24px rgba(0,0,0,0.5), inset 0 2px 4px rgba(255,200,150,0.12);
}
.layer-1::after {
  content:''; position:absolute; top:0; left:0; right:0; height:12px;
  background:linear-gradient(to bottom, #d4a080, #c4856a); border-radius:12px 12px 0 0;
}
.layer-1::before {
  content:''; position:absolute; top:-6px; left:10px; right:10px; height:10px;
  background:radial-gradient(ellipse at 50% 0%, rgba(255,210,180,0.35), transparent 70%);
  border-radius:4px;
}
.layer-2 {
  bottom:72px; width:164px; height:54px;
  background:linear-gradient(to bottom, #8b6b4a, #5e4228);
  box-shadow:0 4px 18px rgba(0,0,0,0.5), inset 0 2px 4px rgba(180,130,80,0.12);
}
.layer-2::after {
  content:''; position:absolute; top:0; left:0; right:0; height:10px;
  background:linear-gradient(to bottom, #a07848, #8b6b4a); border-radius:12px 12px 0 0;
}
.layer-3 {
  bottom:120px; width:128px; height:46px;
  background:linear-gradient(to bottom, #c9a84c, #8a6a28);
  box-shadow:0 4px 18px rgba(0,0,0,0.5), inset 0 2px 4px rgba(255,220,100,0.18);
}
.layer-3::after {
  content:''; position:absolute; top:0; left:0; right:0; height:9px;
  background:linear-gradient(to bottom, #e4c060, #c9a84c); border-radius:12px 12px 0 0;
}

.candle {
  position:absolute; bottom:0; width:8px;
  background:linear-gradient(to bottom, #f0dfc0, #d4b87a, #b89040);
  border-radius:3px 3px 2px 2px;
  transform-origin:bottom center; transform:scaleY(0);
  transition:transform 0.55s cubic-bezier(0.34,1.56,0.64,1);
}
.candle.grown { transform:scaleY(1); }
.candle-1 { left:28px; height:32px; }
.candle-2 { left:50%; transform:translateX(-50%) scaleY(0); height:38px; transform-origin:bottom center; }
.candle-2.grown { transform:translateX(-50%) scaleY(1); }
.candle-3 { right:28px; height:30px; }
.candle::before {
  content:''; position:absolute; top:2px; left:50%; transform:translateX(-50%);
  width:2px; height:7px; background:#2a1608; border-radius:1px;
}

.flame-wrap {
  position:absolute; bottom:calc(100% - 4px); left:50%; transform:translateX(-50%);
  opacity:0; transition:opacity 0.7s ease;
}
.flame-wrap.lit { opacity:1; }
.flame { position:relative; width:10px; height:18px; }
.flame-inner {
  position:absolute; bottom:0; left:50%; transform:translateX(-50%);
  width:6px; height:12px;
  background:radial-gradient(ellipse at 50% 80%, #fff8d0, #ffd040, #ff8c20, transparent);
  border-radius:50% 50% 35% 35%; animation:flick 1.8s ease-in-out infinite;
}
.flame-outer {
  position:absolute; bottom:0; left:50%; transform:translateX(-50%);
  width:10px; height:18px;
  background:radial-gradient(ellipse at 50% 70%, rgba(255,140,20,0.5), rgba(255,60,0,0.22), transparent);
  border-radius:50% 50% 35% 35%; animation:flick-o 2.3s ease-in-out infinite 0.15s;
}
.flame-glow {
  position:absolute; bottom:-4px; left:50%; transform:translateX(-50%);
  width:22px; height:22px; border-radius:50%;
  background:radial-gradient(circle, rgba(255,180,40,0.28), transparent 70%);
  animation:glow-p 1.6s ease-in-out infinite 0.3s;
}
@keyframes flick {
  0%   { transform:translateX(-50%) scaleX(1)    scaleY(1)    rotate(0deg);    opacity:.95; }
  20%  { transform:translateX(-50%) scaleX(.88)  scaleY(1.08) rotate(-1.5deg); opacity:1;   }
  40%  { transform:translateX(-50%) scaleX(1.06) scaleY(.96)  rotate(1deg);    opacity:.9;  }
  60%  { transform:translateX(-50%) scaleX(.92)  scaleY(1.05) rotate(-.5deg);  opacity:1;   }
  80%  { transform:translateX(-50%) scaleX(1.04) scaleY(.98)  rotate(1.5deg);  opacity:.88; }
  100% { transform:translateX(-50%) scaleX(1)    scaleY(1)    rotate(0deg);    opacity:.95; }
}
@keyframes flick-o {
  0%   { transform:translateX(-50%) scaleX(1)    scaleY(1)   rotate(0deg);   opacity:.5;  }
  25%  { transform:translateX(-50%) scaleX(.82)  scaleY(1.1) rotate(2deg);   opacity:.62; }
  50%  { transform:translateX(-50%) scaleX(1.08) scaleY(.9)  rotate(-1deg);  opacity:.42; }
  75%  { transform:translateX(-50%) scaleX(.9)   scaleY(1.06)rotate(1.5deg); opacity:.58; }
  100% { transform:translateX(-50%) scaleX(1)    scaleY(1)   rotate(0deg);   opacity:.5;  }
}
@keyframes glow-p {
  0%,100% { opacity:.4;  transform:translateX(-50%) scale(1);   }
  50%     { opacity:.78; transform:translateX(-50%) scale(1.3); }
}

.layer-3 { position:absolute; }
#candle-container {
  position:absolute; bottom:155px; left:50%; transform:translateX(-50%);
  width:128px; height:40px;
}

.cake-verse {
  font-family:'Cormorant Garamond',serif; font-style:italic; font-weight:300;
  font-size:clamp(1rem,2.8vw,1.25rem); color:var(--t2);
  text-align:center; line-height:2.3;
  opacity:0; transform:translateY(12px);
  transition:opacity 1.3s ease 0.3s, transform 1.3s ease 0.3s;
  max-width:380px;
}
.cake-verse.visible { opacity:1; transform:translateY(0); }

/* ════════════════════════════════════════════════
   TREE SECTION
════════════════════════════════════════════════ */
#tree-section {
  background:linear-gradient(to bottom, #050e07 0%, #040c05 60%, #040b05 100%);
  gap:2rem; padding-top:8rem; padding-bottom:8rem;
}
.tree-container {
  width:min(560px,92vw); display:flex; flex-direction:column;
  align-items:center; gap:2.8rem;
}

#tree-svg {
  width:100%; height:auto; overflow:visible;
  animation:sway 14s ease-in-out infinite;
  transform-origin:280px 490px;
}
@keyframes sway {
  0%,100% { transform:rotate(0deg); }
  30%     { transform:rotate(0.4deg); }
  70%     { transform:rotate(-0.3deg); }
}

.tree-root {
  stroke:#42300f; stroke-width:3; fill:none; stroke-linecap:round;
  stroke-dasharray:var(--len,120); stroke-dashoffset:var(--len,120);
  transition:stroke-dashoffset 0.9s cubic-bezier(0.4,0,0.2,1);
}
.tree-root.drawn { stroke-dashoffset:0; }
.tree-trunk {
  fill:none; stroke:#543818; stroke-width:18; stroke-linecap:round; stroke-linejoin:round;
  stroke-dasharray:260; stroke-dashoffset:260;
  transition:stroke-dashoffset 1.2s cubic-bezier(0.4,0,0.2,1);
}
.tree-trunk.drawn { stroke-dashoffset:0; }
.tree-trunk-inner {
  fill:none; stroke:#724a22; stroke-width:7; stroke-linecap:round;
  stroke-dasharray:240; stroke-dashoffset:240;
  transition:stroke-dashoffset 1.2s cubic-bezier(0.4,0,0.2,1) 0.1s;
}
.tree-trunk-inner.drawn { stroke-dashoffset:0; }
.tree-branch {
  fill:none; stroke-linecap:round; stroke-linejoin:round;
  stroke-dasharray:var(--blen,80); stroke-dashoffset:var(--blen,80);
  transition:stroke-dashoffset 0.6s cubic-bezier(0.4,0,0.2,1);
}
.tree-branch.drawn { stroke-dashoffset:0; }
.tree-leaf { opacity:0; transition:opacity 0.55s ease; }
.tree-leaf.visible { opacity:1; }

.tree-quote {
  font-family:'Cormorant Garamond',serif; font-style:italic; font-weight:300;
  font-size:clamp(1.05rem,3vw,1.32rem); color:var(--t2);
  text-align:center; line-height:2.2; letter-spacing:0.02em;
  opacity:0; transform:translateY(16px);
  transition:opacity 1.5s ease, transform 1.5s ease; max-width:420px;
}
.tree-quote.visible { opacity:1; transform:translateY(0); }
.tree-quote em { color:rgba(165,205,142,0.7); font-style:normal; }

/* ════════════════════════════════════════════════
   FINAL SECTION
════════════════════════════════════════════════ */
#final-section {
  background:linear-gradient(to bottom, #050c07, #0d0804, #120706);
  gap:0;
}
.final-inner {
  display:flex; flex-direction:column; align-items:center; gap:2.6rem;
  max-width:480px; text-align:center;
}
.final-ornament {
  width:50px; height:1px;
  background:linear-gradient(to right, transparent, var(--gold), transparent);
  opacity:0; transition:opacity 1.3s ease, width 1.3s ease;
}
.final-ornament.visible { opacity:0.38; width:105px; }

.final-heading {
  font-family:'Cormorant Garamond',serif; font-weight:300;
  font-size:clamp(2.2rem,8vw,4rem);
  color:transparent;
  background:linear-gradient(135deg, #c8a44a 20%, #e8c87a 55%, #9c7224 100%);
  -webkit-background-clip:text; background-clip:text;
  line-height:1.25; letter-spacing:0.01em;
  opacity:0; transform:scale(0.93);
  transition:opacity 1.6s ease, transform 1.6s cubic-bezier(0.34,1.1,0.64,1);
}
.final-heading.visible { opacity:1; transform:scale(1); }

.final-wish {
  font-family:'Cormorant Garamond',serif; font-weight:300;
  font-size:clamp(1rem,2.9vw,1.35rem); color:var(--t2); line-height:2.2;
  opacity:0; transform:translateY(16px);
  transition:opacity 1.5s ease 0.4s, transform 1.5s ease 0.4s;
}
.final-wish.visible { opacity:1; transform:translateY(0); }

.final-close {
  font-family:'Jost',sans-serif; font-weight:200;
  font-size:clamp(0.58rem,1.5vw,0.7rem);
  letter-spacing:0.48em; text-transform:uppercase;
  color:var(--t4); opacity:0; transition:opacity 1.8s ease 0.8s;
}
.final-close.visible { opacity:1; }

/* Warm ambient bleed from bottom */
.bg-warmth {
  position:fixed; inset:0;
  background:radial-gradient(ellipse at bottom center, rgba(48,12,4,0.5), transparent 72%);
  pointer-events:none; z-index:0; opacity:0; transition:opacity 2.5s ease;
}

#countdown-section,#opening,#cake-section,#tree-section,#final-section { position:relative; z-index:1; }

@media (prefers-reduced-motion:reduce) {
  *, *::before, *::after { animation-duration:0.01ms !important; transition-duration:0.3s !important; }
}
</style>
</head>
<body>

<div id="progress-line"></div>
<div class="bg-warmth" id="bg-warmth"></div>

<!-- ═══════════════════════════════════════════════════
     COUNTDOWN
═══════════════════════════════════════════════════ -->
<section id="countdown-section">
  <div class="star-field" id="star-field"></div>

  <p class="clock-eyebrow" id="clock-eyebrow">time already lived</p>

  <div class="flip-clock" id="flip-clock">

    <!-- DAYS -->
    <div class="flip-unit">
      <div class="f-card" id="card-days">
        <div class="f-card-back"></div>
        <div class="f-top-half"><div class="f-top-half-num" id="th-days">0000</div></div>
        <div class="f-bot-half"><div class="f-bot-half-num" id="bh-days">0000</div></div>
        <div class="f-flap"   id="flap-days">  <div class="f-flap-face"   id="ff-days">0000</div></div>
        <div class="f-reveal" id="reveal-days"><div class="f-reveal-face" id="rf-days">0000</div></div>
        <div class="f-seam"></div>
      </div>
      <span class="f-label">days</span>
    </div>

    <div class="f-colon"><div class="f-dot"></div><div class="f-dot"></div></div>

    <!-- HOURS -->
    <div class="flip-unit">
      <div class="f-card" id="card-hrs">
        <div class="f-card-back"></div>
        <div class="f-top-half"><div class="f-top-half-num" id="th-hrs">00</div></div>
        <div class="f-bot-half"><div class="f-bot-half-num" id="bh-hrs">00</div></div>
        <div class="f-flap"   id="flap-hrs">  <div class="f-flap-face"   id="ff-hrs">00</div></div>
        <div class="f-reveal" id="reveal-hrs"><div class="f-reveal-face" id="rf-hrs">00</div></div>
        <div class="f-seam"></div>
      </div>
      <span class="f-label">hours</span>
    </div>

    <div class="f-colon"><div class="f-dot"></div><div class="f-dot"></div></div>

    <!-- MINUTES -->
    <div class="flip-unit">
      <div class="f-card" id="card-min">
        <div class="f-card-back"></div>
        <div class="f-top-half"><div class="f-top-half-num" id="th-min">00</div></div>
        <div class="f-bot-half"><div class="f-bot-half-num" id="bh-min">00</div></div>
        <div class="f-flap"   id="flap-min">  <div class="f-flap-face"   id="ff-min">00</div></div>
        <div class="f-reveal" id="reveal-min"><div class="f-reveal-face" id="rf-min">00</div></div>
        <div class="f-seam"></div>
      </div>
      <span class="f-label">minutes</span>
    </div>

    <div class="f-colon"><div class="f-dot"></div><div class="f-dot"></div></div>

    <!-- SECONDS -->
    <div class="flip-unit">
      <div class="f-card" id="card-sec">
        <div class="f-card-back"></div>
        <div class="f-top-half"><div class="f-top-half-num" id="th-sec">00</div></div>
        <div class="f-bot-half"><div class="f-bot-half-num" id="bh-sec">00</div></div>
        <div class="f-flap"   id="flap-sec">  <div class="f-flap-face"   id="ff-sec">00</div></div>
        <div class="f-reveal" id="reveal-sec"><div class="f-reveal-face" id="rf-sec">00</div></div>
        <div class="f-seam"></div>
      </div>
      <span class="f-label">seconds</span>
    </div>

  </div><!-- /flip-clock -->

  <div class="clock-below" id="clock-below">
    <p class="clock-main-line">
      Time does not keep its count for things it means to let go.
    </p>
    <p class="clock-sub-lines">
      These are not the numbers of your age.<br>
      They are the record of every second<br>
      that chose to carry you forward.<br>
      All of them did.
    </p>
  </div>

  <div class="scroll-hint">
    <span>scroll</span>
    <div class="scroll-bar"></div>
  </div>
</section>

<!-- ═══════════════════════════════════════════════════
     OPENING
═══════════════════════════════════════════════════ -->
<section id="opening">
  <p class="opening-line d1" data-observe="fade">Some things endure not because they are strong,</p>
  <p class="opening-line d2" data-observe="fade">but because they were quietly needed.</p>
  <p class="opening-line d3" data-observe="fade">You are proof of that.</p>
  <div class="section-divider" data-observe="fade"></div>
</section>

<!-- ═══════════════════════════════════════════════════
     CAKE
═══════════════════════════════════════════════════ -->
<section id="cake-section">
  <p class="cake-title" data-observe="fade">what the years left behind</p>

  <div class="cake-stage" id="cake-stage">
    <div class="plate-group" id="plate">
      <div class="plate-rim"></div>
      <div class="plate-ellipse"></div>
    </div>
    <div class="layer layer-1" id="cake-layer-1"></div>
    <div class="layer layer-2" id="cake-layer-2"></div>
    <div class="layer layer-3" id="cake-layer-3"></div>
    <div id="candle-container">
      <div class="candle candle-1" id="candle-1">
        <div class="flame-wrap" id="flame-1">
          <div class="flame"><div class="flame-glow"></div><div class="flame-outer"></div><div class="flame-inner"></div></div>
        </div>
      </div>
      <div class="candle candle-2" id="candle-2">
        <div class="flame-wrap" id="flame-2">
          <div class="flame"><div class="flame-glow"></div><div class="flame-outer"></div><div class="flame-inner"></div></div>
        </div>
      </div>
      <div class="candle candle-3" id="candle-3">
        <div class="flame-wrap" id="flame-3">
          <div class="flame"><div class="flame-glow"></div><div class="flame-outer"></div><div class="flame-inner"></div></div>
        </div>
      </div>
    </div>
  </div>

  <p class="cake-verse" data-observe="fade">
    Each layer settled without noise.<br>
    Each flame found its way without being asked.<br>
    A year does not need to be celebrated<br>
    to have meant something.
  </p>
</section>

<!-- ═══════════════════════════════════════════════════
     TREE
═══════════════════════════════════════════════════ -->
<section id="tree-section">
  <div class="tree-container">
    <svg id="tree-svg" viewBox="0 0 560 520" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <filter id="bark" x="-10%" y="-10%" width="120%" height="120%">
          <feTurbulence type="fractalNoise" baseFrequency="0.04 0.1" numOctaves="3" seed="5"/>
          <feColorMatrix type="saturate" values="0"/>
          <feBlend in="SourceGraphic" mode="multiply"/>
        </filter>
        <radialGradient id="lg1" cx="50%" cy="50%" r="50%">
          <stop offset="0%" stop-color="#3a6e2e"/><stop offset="100%" stop-color="#1c4816"/>
        </radialGradient>
        <radialGradient id="lg2" cx="50%" cy="50%" r="50%">
          <stop offset="0%" stop-color="#477c36"/><stop offset="100%" stop-color="#24581c"/>
        </radialGradient>
        <radialGradient id="lg3" cx="50%" cy="50%" r="50%">
          <stop offset="0%" stop-color="#2e5c26"/><stop offset="100%" stop-color="#143a0e"/>
        </radialGradient>
        <radialGradient id="lg4" cx="50%" cy="50%" r="50%">
          <stop offset="0%" stop-color="#528640"/><stop offset="100%" stop-color="#305e2c"/>
        </radialGradient>
        <linearGradient id="gg" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stop-color="#1c3816"/><stop offset="100%" stop-color="#0c1e08"/>
        </linearGradient>
      </defs>

      <ellipse cx="280" cy="500" rx="180" ry="16" fill="url(#gg)" opacity="0.5"/>

      <path class="tree-root" id="root-1" style="--len:110" d="M 258 488 Q 230 490 200 500"/>
      <path class="tree-root" id="root-2" style="--len:100" d="M 262 490 Q 240 496 220 508" stroke-width="2.5"/>
      <path class="tree-root" id="root-3" style="--len:90"  d="M 270 492 Q 258 498 248 510" stroke-width="2"/>
      <path class="tree-root" id="root-4" style="--len:110" d="M 282 488 Q 310 490 338 502"/>
      <path class="tree-root" id="root-5" style="--len:100" d="M 278 490 Q 302 496 320 508" stroke-width="2.5"/>
      <path class="tree-root" id="root-6" style="--len:80"  d="M 272 492 Q 285 498 295 510" stroke-width="2"/>

      <path class="tree-trunk" id="trunk" d="M 270 488 Q 264 440 268 380 Q 272 310 270 250 Q 268 200 272 160"/>
      <path class="tree-trunk-inner" id="trunk-inner" d="M 276 488 Q 270 440 274 380 Q 278 310 276 250 Q 274 200 278 160" stroke-width="4"/>

      <path class="tree-branch" id="b1"  style="--blen:140" stroke="#503616" stroke-width="7"   d="M 270 380 Q 230 350 175 320 Q 145 305 110 300"/>
      <path class="tree-branch" id="b2"  style="--blen:120" stroke="#634422" stroke-width="5"   d="M 268 340 Q 235 318 200 295 Q 175 280 150 268"/>
      <path class="tree-branch" id="b3"  style="--blen:100" stroke="#6a4c2c" stroke-width="4"   d="M 272 300 Q 245 282 215 265 Q 192 252 168 244"/>
      <path class="tree-branch" id="b4"  style="--blen:90"  stroke="#755634" stroke-width="3.5" d="M 270 260 Q 248 242 225 228 Q 205 216 182 210"/>
      <path class="tree-branch" id="b5"  style="--blen:80"  stroke="#826040" stroke-width="3"   d="M 272 225 Q 252 210 232 198 Q 215 188 195 184"/>
      <path class="tree-branch" id="b6"  style="--blen:145" stroke="#503616" stroke-width="7"   d="M 270 370 Q 312 340 360 312 Q 395 292 430 285"/>
      <path class="tree-branch" id="b7"  style="--blen:125" stroke="#634422" stroke-width="5"   d="M 272 328 Q 308 306 345 288 Q 372 274 400 265"/>
      <path class="tree-branch" id="b8"  style="--blen:105" stroke="#6a4c2c" stroke-width="4"   d="M 272 292 Q 300 272 328 258 Q 350 245 375 238"/>
      <path class="tree-branch" id="b9"  style="--blen:88"  stroke="#755634" stroke-width="3.5" d="M 271 255 Q 296 238 320 226 Q 340 215 362 210"/>
      <path class="tree-branch" id="b10" style="--blen:78"  stroke="#826040" stroke-width="3"   d="M 273 222 Q 295 208 318 196 Q 336 186 355 182"/>
      <path class="tree-branch" id="b11" style="--blen:90"  stroke="#826040" stroke-width="3"   d="M 272 195 Q 255 180 235 165 Q 218 153 198 145"/>
      <path class="tree-branch" id="b12" style="--blen:85"  stroke="#826040" stroke-width="3"   d="M 272 195 Q 292 178 312 165 Q 330 153 348 148"/>
      <path class="tree-branch" id="b13" style="--blen:70"  stroke="#906e4a" stroke-width="2.5" d="M 272 175 Q 265 158 252 142 Q 241 130 228 122"/>
      <path class="tree-branch" id="b14" style="--blen:70"  stroke="#906e4a" stroke-width="2.5" d="M 273 175 Q 282 157 296 142 Q 308 130 322 122"/>
      <path class="tree-branch" id="b15" style="--blen:60"  stroke="#906e4a" stroke-width="2.5" d="M 271 165 Q 262 148 248 135 Q 236 124 222 118"/>
      <path class="tree-branch" id="b16" style="--blen:65"  stroke="#9a7c54" stroke-width="2"   d="M 175 320 Q 158 300 138 285 Q 122 272 105 266"/>
      <path class="tree-branch" id="b17" style="--blen:55"  stroke="#a2845c" stroke-width="2"   d="M 150 268 Q 132 252 112 240 Q 98 230 82 226"/>
      <path class="tree-branch" id="b18" style="--blen:50"  stroke="#a2845c" stroke-width="1.5" d="M 182 210 Q 165 196 148 185 Q 133 175 118 172"/>
      <path class="tree-branch" id="b19" style="--blen:65"  stroke="#9a7c54" stroke-width="2"   d="M 430 285 Q 448 268 462 250 Q 473 236 482 225"/>
      <path class="tree-branch" id="b20" style="--blen:55"  stroke="#a2845c" stroke-width="2"   d="M 400 265 Q 420 248 436 232 Q 448 219 458 210"/>
      <path class="tree-branch" id="b21" style="--blen:50"  stroke="#a2845c" stroke-width="1.5" d="M 362 210 Q 378 194 390 180 Q 400 168 408 158"/>
      <path class="tree-branch" id="b22" style="--blen:45"  stroke="#a2845c" stroke-width="1.5" d="M 228 122 Q 218 106 208 90 Q 200 77 194 68"/>
      <path class="tree-branch" id="b23" style="--blen:45"  stroke="#a2845c" stroke-width="1.5" d="M 322 122 Q 334 106 344 90 Q 352 77 357 68"/>
      <path class="tree-branch" id="b24" style="--blen:40"  stroke="#a2845c" stroke-width="1.5" d="M 198 145 Q 185 128 174 114 Q 165 102 158 95"/>
      <path class="tree-branch" id="b25" style="--blen:40"  stroke="#a2845c" stroke-width="1.5" d="M 348 148 Q 362 130 372 116 Q 380 104 388 96"/>
      <path class="tree-branch" id="b26" style="--blen:35"  stroke="#aa9068" stroke-width="1"   d="M 271 160 Q 272 142 272 126 Q 272 115 273 105"/>

      <g id="leaves-left-low">
        <ellipse class="tree-leaf" cx="112" cy="290" rx="42" ry="30" fill="url(#lg1)" opacity="0.94"/>
        <ellipse class="tree-leaf" cx="88"  cy="278" rx="35" ry="24" fill="url(#lg3)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="138" cy="270" rx="38" ry="26" fill="url(#lg2)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="105" cy="258" rx="30" ry="22" fill="url(#lg4)" opacity="0.87"/>
        <ellipse class="tree-leaf" cx="162" cy="296" rx="32" ry="22" fill="url(#lg1)" opacity="0.89"/>
      </g>
      <g id="leaves-left-mid">
        <ellipse class="tree-leaf" cx="82"  cy="228" rx="38" ry="26" fill="url(#lg2)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="60"  cy="218" rx="30" ry="20" fill="url(#lg3)" opacity="0.87"/>
        <ellipse class="tree-leaf" cx="110" cy="214" rx="34" ry="24" fill="url(#lg4)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="90"  cy="200" rx="28" ry="20" fill="url(#lg1)" opacity="0.86"/>
        <ellipse class="tree-leaf" cx="128" cy="200" rx="30" ry="21" fill="url(#lg3)" opacity="0.88"/>
      </g>
      <g id="leaves-left-up">
        <ellipse class="tree-leaf" cx="118" cy="170" rx="36" ry="26" fill="url(#lg1)" opacity="0.91"/>
        <ellipse class="tree-leaf" cx="96"  cy="158" rx="30" ry="22" fill="url(#lg2)" opacity="0.88"/>
        <ellipse class="tree-leaf" cx="144" cy="155" rx="32" ry="23" fill="url(#lg4)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="168" cy="162" rx="28" ry="20" fill="url(#lg3)" opacity="0.86"/>
      </g>
      <g id="leaves-right-low">
        <ellipse class="tree-leaf" cx="448" cy="278" rx="42" ry="30" fill="url(#lg1)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="474" cy="266" rx="34" ry="24" fill="url(#lg3)" opacity="0.89"/>
        <ellipse class="tree-leaf" cx="422" cy="264" rx="36" ry="25" fill="url(#lg2)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="454" cy="252" rx="30" ry="21" fill="url(#lg4)" opacity="0.87"/>
        <ellipse class="tree-leaf" cx="400" cy="272" rx="30" ry="21" fill="url(#lg1)" opacity="0.89"/>
      </g>
      <g id="leaves-right-mid">
        <ellipse class="tree-leaf" cx="460" cy="212" rx="36" ry="26" fill="url(#lg2)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="482" cy="200" rx="28" ry="20" fill="url(#lg3)" opacity="0.87"/>
        <ellipse class="tree-leaf" cx="436" cy="196" rx="34" ry="23" fill="url(#lg4)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="408" cy="200" rx="28" ry="20" fill="url(#lg1)" opacity="0.86"/>
        <ellipse class="tree-leaf" cx="420" cy="180" rx="26" ry="18" fill="url(#lg3)" opacity="0.84"/>
      </g>
      <g id="leaves-right-up">
        <ellipse class="tree-leaf" cx="410" cy="158" rx="34" ry="25" fill="url(#lg1)" opacity="0.91"/>
        <ellipse class="tree-leaf" cx="388" cy="148" rx="30" ry="22" fill="url(#lg2)" opacity="0.88"/>
        <ellipse class="tree-leaf" cx="436" cy="144" rx="28" ry="20" fill="url(#lg4)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="456" cy="152" rx="26" ry="18" fill="url(#lg3)" opacity="0.85"/>
      </g>
      <g id="leaves-center-up">
        <ellipse class="tree-leaf" cx="228" cy="108" rx="38" ry="28" fill="url(#lg1)" opacity="0.93"/>
        <ellipse class="tree-leaf" cx="255" cy="96"  rx="34" ry="25" fill="url(#lg4)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="202" cy="96"  rx="30" ry="22" fill="url(#lg2)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="272" cy="88"  rx="36" ry="28" fill="url(#lg3)" opacity="0.94"/>
        <ellipse class="tree-leaf" cx="300" cy="96"  rx="34" ry="24" fill="url(#lg1)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="324" cy="108" rx="36" ry="27" fill="url(#lg4)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="350" cy="102" rx="30" ry="22" fill="url(#lg2)" opacity="0.89"/>
        <ellipse class="tree-leaf" cx="272" cy="70"  rx="28" ry="22" fill="url(#lg3)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="250" cy="72"  rx="24" ry="18" fill="url(#lg4)" opacity="0.86"/>
        <ellipse class="tree-leaf" cx="295" cy="72"  rx="25" ry="19" fill="url(#lg1)" opacity="0.87"/>
      </g>
      <g id="leaves-center-mid">
        <ellipse class="tree-leaf" cx="200" cy="140" rx="38" ry="28" fill="url(#lg2)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="235" cy="128" rx="34" ry="24" fill="url(#lg1)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="310" cy="128" rx="34" ry="24" fill="url(#lg3)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="345" cy="138" rx="36" ry="26" fill="url(#lg4)" opacity="0.92"/>
        <ellipse class="tree-leaf" cx="270" cy="118" rx="30" ry="22" fill="url(#lg1)" opacity="0.89"/>
        <ellipse class="tree-leaf" cx="178" cy="152" rx="32" ry="22" fill="url(#lg3)" opacity="0.88"/>
        <ellipse class="tree-leaf" cx="362" cy="148" rx="30" ry="21" fill="url(#lg2)" opacity="0.88"/>
      </g>
      <g id="leaves-mid-spread">
        <ellipse class="tree-leaf" cx="155" cy="248" rx="36" ry="26" fill="url(#lg4)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="178" cy="232" rx="32" ry="22" fill="url(#lg1)" opacity="0.88"/>
        <ellipse class="tree-leaf" cx="140" cy="228" rx="28" ry="20" fill="url(#lg3)" opacity="0.86"/>
        <ellipse class="tree-leaf" cx="388" cy="244" rx="34" ry="25" fill="url(#lg2)" opacity="0.9"/>
        <ellipse class="tree-leaf" cx="365" cy="228" rx="30" ry="22" fill="url(#lg4)" opacity="0.88"/>
        <ellipse class="tree-leaf" cx="408" cy="228" rx="28" ry="20" fill="url(#lg1)" opacity="0.86"/>
        <ellipse class="tree-leaf" cx="215" cy="178" rx="34" ry="24" fill="url(#lg2)" opacity="0.89"/>
        <ellipse class="tree-leaf" cx="330" cy="176" rx="34" ry="24" fill="url(#lg3)" opacity="0.89"/>
        <ellipse class="tree-leaf" cx="245" cy="158" rx="30" ry="22" fill="url(#lg4)" opacity="0.87"/>
        <ellipse class="tree-leaf" cx="300" cy="156" rx="32" ry="23" fill="url(#lg1)" opacity="0.88"/>
      </g>
    </svg>

    <p class="tree-quote" id="tree-quote">
      The roots went down before the ground was kind.<br>
      The shade arrived without asking who needed it.<br>
      <em>What grows in silence<br>does not need to be seen to hold.</em>
    </p>
  </div>
</section>

<!-- ═══════════════════════════════════════════════════
     FINAL
═══════════════════════════════════════════════════ -->
<section id="final-section">
  <div class="final-inner">
    <div class="final-ornament" data-observe="final"></div>

    <h2 class="final-heading" data-observe="final" style="transition-delay:0.2s">
      Still here.<br>Still whole.
    </h2>

    <p class="final-wish" data-observe="final" style="transition-delay:0.5s">
      May this year ask less of you<br>
      than you have already given.<br>
      May something find you<br>
      that you stopped looking for.<br>
      May rest, when it comes,<br>
      feel like it was always yours.
    </p>

    <p class="final-close" data-observe="final" style="transition-delay:0.9s">
      happy birthday
    </p>

    <div class="final-ornament" data-observe="final" style="transition-delay:1.2s"></div>
  </div>
</section>

<script>
/* ════════════════════════════════════════════════
   STARS
════════════════════════════════════════════════ */
(function(){
  const f = document.getElementById('star-field');
  for(let i=0; i<115; i++){
    const s = document.createElement('div');
    s.className = 'star';
    const sz = Math.random()*1.7 + 0.35;
    s.style.cssText = `width:${sz}px;height:${sz}px;top:${Math.random()*100}%;left:${Math.random()*100}%;`
      + `--d:${2+Math.random()*5}s;--dl:${-(Math.random()*7).toFixed(2)}s;`
      + `--lo:${(0.03+Math.random()*0.08).toFixed(3)};--hi:${(0.24+Math.random()*0.4).toFixed(3)};`;
    f.appendChild(s);
  }
})();

/* ════════════════════════════════════════════════
   FLIP CLOCK ENGINE
   — Physical 4-panel approach:
     top-half  : shows current value (top portion)
     bot-half  : shows current value (bottom portion, slightly dimmer)
     flap      : top flap showing OLD value, folds down during flip
     reveal    : bottom flap showing NEW value, unfolds up during flip
════════════════════════════════════════════════ */
const BIRTH = new Date('2006-02-25T00:00:00');

// State table
const clocks = {
  days: { cur:null, th:'th-days', bh:'bh-days', flap:'flap-days', ff:'ff-days', reveal:'reveal-days', rf:'rf-days', pad:4 },
  hrs:  { cur:null, th:'th-hrs',  bh:'bh-hrs',  flap:'flap-hrs',  ff:'ff-hrs',  reveal:'reveal-hrs',  rf:'rf-hrs',  pad:2 },
  min:  { cur:null, th:'th-min',  bh:'bh-min',  flap:'flap-min',  ff:'ff-min',  reveal:'reveal-min',  rf:'rf-min',  pad:2 },
  sec:  { cur:null, th:'th-sec',  bh:'bh-sec',  flap:'flap-sec',  ff:'ff-sec',  reveal:'reveal-sec',  rf:'rf-sec',  pad:2 },
};

function pad(n, len){ return String(Math.floor(n)).padStart(len,'0'); }

function getElapsed(){
  const ms   = Math.max(0, Date.now() - BIRTH.getTime());
  const ts   = Math.floor(ms / 1000);
  const sec  = ts % 60;
  const tm   = Math.floor(ts / 60);
  const min  = tm % 60;
  const th   = Math.floor(tm / 60);
  const hrs  = th % 24;
  const days = Math.floor(th / 24);
  return { days, hrs, min, sec };
}

// Initialise all static panels with current value (no animation)
function initDisplay(){
  const v = getElapsed();
  ['days','hrs','min','sec'].forEach(k => {
    const c = clocks[k];
    const str = pad(v[k], c.pad);
    c.cur = str;
    document.getElementById(c.th).textContent = str;
    document.getElementById(c.bh).textContent = str;
    document.getElementById(c.ff).textContent = str;
    document.getElementById(c.rf).textContent = str;
  });
}

// Trigger a single flip for one unit
const flipping = {};
function triggerFlip(k, newStr){
  const c = clocks[k];
  if(flipping[k]) return; // already mid-flip, skip
  flipping[k] = true;

  const oldStr = c.cur;
  c.cur = newStr;

  const flapEl   = document.getElementById(c.flap);
  const revealEl = document.getElementById(c.reveal);
  const ffEl     = document.getElementById(c.ff);
  const rfEl     = document.getElementById(c.rf);
  const thEl     = document.getElementById(c.th);
  const bhEl     = document.getElementById(c.bh);

  // Set flap to show OLD value, reveal to show NEW value
  ffEl.textContent = oldStr;
  rfEl.textContent = newStr;

  // Update static halves immediately — they sit behind
  thEl.textContent = newStr;
  bhEl.textContent = newStr;

  // Remove then re-add class to re-trigger animation
  flapEl.classList.remove('animating');
  revealEl.classList.remove('animating');

  // Micro-reflow to reset animation state
  void flapEl.offsetWidth;

  flapEl.classList.add('animating');
  revealEl.classList.add('animating');

  // Cleanup — total animation is 0.22s fall + 0.22s delay + 0.22s rise = 0.66s
  setTimeout(() => {
    flapEl.classList.remove('animating');
    revealEl.classList.remove('animating');
    flipping[k] = false;
  }, 700);
}

function tick(){
  const v = getElapsed();
  const map = { days: pad(v.days,4), hrs: pad(v.hrs,2), min: pad(v.min,2), sec: pad(v.sec,2) };
  ['days','hrs','min','sec'].forEach(k => {
    if(map[k] !== clocks[k].cur){ triggerFlip(k, map[k]); }
  });
}

// Boot
initDisplay();
setInterval(tick, 1000);

// Animate clock in
window.addEventListener('load', () => {
  setTimeout(() => {
    document.getElementById('clock-eyebrow').classList.add('visible');
    document.getElementById('flip-clock').classList.add('visible');
    setTimeout(() => document.getElementById('clock-below').classList.add('visible'), 950);
  }, 280);
});

/* ════════════════════════════════════════════════
   SCROLL — progress + warmth
════════════════════════════════════════════════ */
const progEl = document.getElementById('progress-line');
const warmEl = document.getElementById('bg-warmth');
window.addEventListener('scroll', () => {
  const pct = Math.min(100, window.scrollY / (document.body.scrollHeight - window.innerHeight) * 100);
  progEl.style.width = pct + '%';
  warmEl.style.opacity = Math.max(0, (pct - 58) / 42);
}, { passive:true });

/* ════════════════════════════════════════════════
   INTERSECTION OBSERVERS
════════════════════════════════════════════════ */
const fadeObs = new IntersectionObserver(entries => {
  entries.forEach(e => { if(e.isIntersecting) e.target.classList.add('visible'); });
}, { threshold:0.2 });
document.querySelectorAll('[data-observe="fade"]').forEach(el => fadeObs.observe(el));

const finalObs = new IntersectionObserver(entries => {
  entries.forEach(e => { if(e.isIntersecting) e.target.classList.add('visible'); });
}, { threshold:0.15 });
document.querySelectorAll('[data-observe="final"]').forEach(el => finalObs.observe(el));

/* ════════════════════════════════════════════════
   CAKE ANIMATION
════════════════════════════════════════════════ */
let cakeDone = false;
const cakeObs = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if(e.isIntersecting && !cakeDone){ cakeDone=true; runCake(); cakeObs.unobserve(e.target); }
  });
}, { threshold:0.3 });
cakeObs.observe(document.getElementById('cake-stage'));

function wait(ms){ return new Promise(r => setTimeout(r,ms)); }

async function runCake(){
  await wait(200);
  const pl = document.getElementById('plate');
  pl.style.transition = 'transform 0.85s cubic-bezier(0.25,1.4,0.5,1), opacity 0.3s ease';
  pl.classList.add('dropped');

  await wait(700);
  const l1 = document.getElementById('cake-layer-1');
  l1.classList.add('dropped'); l1.style.transform = 'translateX(-50%) translateY(0)';
  await wait(500);
  const l2 = document.getElementById('cake-layer-2');
  l2.classList.add('dropped'); l2.style.transform = 'translateX(-50%) translateY(0)';
  await wait(500);
  const l3 = document.getElementById('cake-layer-3');
  l3.classList.add('dropped'); l3.style.transform = 'translateX(-50%) translateY(0)';

  await wait(600);
  document.getElementById('candle-1').classList.add('grown');
  await wait(500);
  document.getElementById('candle-2').classList.add('grown');
  await wait(500);
  document.getElementById('candle-3').classList.add('grown');

  await wait(400);
  document.getElementById('flame-1').classList.add('lit');
  await wait(300);
  document.getElementById('flame-2').classList.add('lit');
  await wait(300);
  document.getElementById('flame-3').classList.add('lit');
}

['cake-layer-1','cake-layer-2','cake-layer-3'].forEach(id => {
  const el = document.getElementById(id);
  el.style.transform = 'translateX(-50%) translateY(-300px)';
  el.style.transition = 'transform 0.72s cubic-bezier(0.22,1.4,0.36,1), opacity 0.3s ease';
});

/* ════════════════════════════════════════════════
   TREE ANIMATION
════════════════════════════════════════════════ */
let treeDone = false;
const treeObs = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if(e.isIntersecting && !treeDone){ treeDone=true; runTree(); treeObs.unobserve(e.target); }
  });
}, { threshold:0.1 });
treeObs.observe(document.getElementById('tree-section'));

async function runTree(){
  document.querySelectorAll('.tree-root').forEach((r,i) => setTimeout(()=>r.classList.add('drawn'), i*180));
  await wait(950);
  document.getElementById('trunk').classList.add('drawn');
  document.getElementById('trunk-inner').classList.add('drawn');
  await wait(1050);
  const branches = document.querySelectorAll('.tree-branch');
  branches.forEach((b,i) => setTimeout(()=>b.classList.add('drawn'), i*125));
  await wait(branches.length*125 + 350);

  const groups = [
    'leaves-left-low','leaves-right-low','leaves-left-mid','leaves-right-mid',
    'leaves-center-mid','leaves-mid-spread','leaves-left-up','leaves-right-up','leaves-center-up'
  ];
  for(const gid of groups){
    await wait(210);
    const g = document.getElementById(gid);
    if(!g) continue;
    g.querySelectorAll('.tree-leaf').forEach((lf,li) => setTimeout(()=>lf.classList.add('visible'), li*35));
  }
  await wait(1000);
  document.getElementById('tree-quote').classList.add('visible');
}
</script>
</body>
</html>